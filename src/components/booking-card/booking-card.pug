include ../date-filter/date-filter.pug
include ../count-picker/count-picker.pug
include ../information-tooltip/information-tooltip.pug

mixin booking-card(opts)
  -
    function formatNumber(num) {
      return num.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1 ').concat('₽');
    }
    var roomPrice = opts.roomPrice ? formatNumber(opts.roomPrice) : '';
    var discount = opts.discount ? formatNumber(opts.discount) : '';
    var initialArrivalDate = opts.initialArrivalDate || '';
    var initialDepartureDate = opts.initialDepartureDate || '';
    var guestPickerItems = [
      { label: 'Взрослые', count: 2 },
      { label: 'Дети', count: 1 },
      { label: 'Младенцы', count: 0 }
    ];

  div(
    class='booking-card'
    class='js-booking-card'
  )
    form
      fieldset.booking-card__fieldset
        legend.booking-card__legend
          .booking-card__room
            | №
            |
            span.booking-card__room-number=opts.roomNumber
            |
            |
            span.booking-card__room-type=opts.roomType
          span.booking-card__price
            span.booking-card__price-value=roomPrice
            span.booking-card__price-period=' в сутки'
        .booking-card__date-filter-container
          +date-filter({
            initialArrivalDate,
            initialDepartureDate,
            arrivalLabel: 'Прибытие',
            departureLabel: 'Выезд',
            separateDates: true,
          })
        .booking-card__guest-picker-container
          +count-picker({
            label: 'Гости',
            inputText: 'Сколько гостей',
            withControlButtons: true,
            items: guestPickerItems,
          })
        ul.booking-card__cost-details-list
          li.booking-card__cost-details-item
            .booking-card__cost-details
              span.js-booking-card__stay-duration
            span.js-booking-card__total-base-cost
          li.booking-card__cost-details-item
            .booking-card__cost-details
              span.js-booking-card__discount='Сбор за услуги: скидка ' + discount
              +information-tooltip('Tooltip')
            span='0₽'
          li.booking-card__cost-details-item
            .booking-card__cost-details
              span='Сбор за дополнительные услуги'
              +information-tooltip('Tooltip')
            span.js-booking-card__additional-services-fees
        .booking-card__total-cost-block
          span.booking-card__total-cost-text
          .booking-card__total-cost-separator
          span(
            class='booking-card__total-cost-text'
            class='js-booking-card__total-cost'
          )
      button(
        class='booking-card__submit-button'
        class='js-booking-card__submit-button'
        type='submit'
      )='Забронировать'
